From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: PurpleWolfMC <jedimastertoothless@hotmail.com>
Date: Sat, 28 Oct 2023 12:39:11 -0700
Subject: [PATCH] Fix ArrayIndexException for MojangGUI


diff --git a/src/main/java/net/minecraft/server/gui/MinecraftServerGui.java b/src/main/java/net/minecraft/server/gui/MinecraftServerGui.java
index d6adb42693f68cd0f7a573463e7477558bbdf394..7e3810d2609c7a89ac775de392ace4ed165ccc43 100644
--- a/src/main/java/net/minecraft/server/gui/MinecraftServerGui.java
+++ b/src/main/java/net/minecraft/server/gui/MinecraftServerGui.java
@@ -298,8 +298,14 @@ public class MinecraftServerGui extends CraftServerGui implements MojangServerGu
         JScrollBar jscrollbar = scrollPane.getVerticalScrollBar();
 
         if (scrollPane.getViewport().getView() == textArea) {
-            boolean atBottom = (double) jscrollbar.getValue() + jscrollbar.getSize().getHeight() + (double) (MinecraftServerGui.FONT.getSize() * 4) > (double) jscrollbar.getMaximum();
-
+            // Canvas start
+            boolean atBottom = false;
+            try{
+                atBottom = (double) jscrollbar.getValue() + jscrollbar.getSize().getHeight() + (double) (MinecraftServerGui.FONT.getSize() * 4) > (double) jscrollbar.getMaximum();
+            } catch (ArrayIndexOutOfBoundsException ignored){
+                // ignore this
+            }
+            // Canvas end
         /* // Purpur
         try {
             document.insertString(document.getLength(), MinecraftServerGui.ANSI.matcher(message).replaceAll(""), (AttributeSet) null); // CraftBukkit
